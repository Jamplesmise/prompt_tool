# API æµ‹è¯•æŠ¥å‘Š

**æµ‹è¯•æ—¶é—´**: 2025-12-04
**æµ‹è¯•èŒƒå›´**: æ‰€æœ‰ 81 ä¸ª API è·¯ç”±
**æµ‹è¯•æ‰§è¡Œ**: 77 ä¸ªç«¯ç‚¹ï¼Œ74 ä¸ªå®é™…æ‰§è¡Œï¼Œ3 ä¸ªè·³è¿‡
**æ•´ä½“é€šè¿‡ç‡**: 73% (54/74)

---

## ğŸ“Š æµ‹è¯•ç»“æœæ±‡æ€»

| æ¨¡å— | é€šè¿‡/æ€»æ•° | é€šè¿‡ç‡ | çŠ¶æ€ |
|------|-----------|--------|------|
| è®¤è¯æ¨¡å— | 2/2 | 100% | âœ… å®Œå…¨é€šè¿‡ |
| ç”¨æˆ·ç®¡ç† | 3/4 | 75% | âš ï¸ éœ€è¦ä¼˜åŒ– |
| æç¤ºè¯ç®¡ç† | 8/11 | 73% | âš ï¸ éœ€è¦ä¼˜åŒ– |
| æ•°æ®é›†ç®¡ç† | 6/8 | 75% | âš ï¸ éœ€è¦ä¼˜åŒ– |
| æ¨¡å‹é…ç½® | 6/7 | 86% | âš ï¸ éœ€è¦ä¼˜åŒ– |
| è¯„ä¼°å™¨ | 4/4 | 100% | âœ… å®Œå…¨é€šè¿‡ |
| ä»»åŠ¡ç®¡ç† | 12/12 | 100% | âœ… å®Œå…¨é€šè¿‡ |
| å®šæ—¶ä»»åŠ¡ | 1/5 | 20% | âŒ éœ€è¦ä¿®å¤ |
| å‘Šè­¦ç³»ç»Ÿ | 2/6 | 33% | âŒ éœ€è¦ä¿®å¤ |
| å›¢é˜Ÿç®¡ç† | 1/7 | 14% | âŒ éœ€è¦ä¿®å¤ |
| API Token | 3/3 | 100% | âœ… å®Œå…¨é€šè¿‡ |
| é€šçŸ¥æ¸ é“ | 1/3 | 33% | âŒ éœ€è¦ä¿®å¤ |
| å®¡è®¡æ—¥å¿— | 1/1 | 100% | âœ… å®Œå…¨é€šè¿‡ |
| å…¨å±€æœç´¢ | 1/1 | 100% | âœ… å®Œå…¨é€šè¿‡ |
| ç»Ÿè®¡æ•°æ® | 3/3 | 100% | âœ… å®Œå…¨é€šè¿‡ |

---

## âœ… å®Œå…¨é€šè¿‡çš„æ¨¡å— (100%)

### 1. è®¤è¯æ¨¡å— (2/2)
- âœ… POST /auth/login - ç™»å½•
- âœ… GET /auth/me - è·å–å½“å‰ç”¨æˆ·

### 2. è¯„ä¼°å™¨ (4/4)
- âœ… GET /evaluators/presets - é¢„ç½®è¯„ä¼°å™¨åˆ—è¡¨
- âœ… GET /evaluators - è¯„ä¼°å™¨åˆ—è¡¨
- âœ… GET /evaluators/:id - è¯„ä¼°å™¨è¯¦æƒ…
- âœ… POST /evaluators/:id/test - æµ‹è¯•è¯„ä¼°å™¨

### 3. ä»»åŠ¡ç®¡ç† (12/12)
- âœ… GET /tasks - ä»»åŠ¡åˆ—è¡¨
- âœ… GET /tasks/:id - ä»»åŠ¡è¯¦æƒ…
- âœ… GET /tasks/:id/progress - ä»»åŠ¡è¿›åº¦
- âœ… GET /tasks/:id/results - ä»»åŠ¡ç»“æœ
- âœ… GET /tasks/:id/results/export - å¯¼å‡ºç»“æœ
- âœ… GET /tasks/:id/ab-results - A/B æµ‹è¯•ç»“æœ
- âœ… POST /tasks/:id/pause - æš‚åœä»»åŠ¡
- âœ… POST /tasks/:id/resume - æ¢å¤ä»»åŠ¡
- âœ… POST /tasks/:id/stop - åœæ­¢ä»»åŠ¡
- âœ… POST /tasks/:id/retry - é‡è¯•ä»»åŠ¡
- âœ… POST /tasks/:id/run - è¿è¡Œä»»åŠ¡
- âœ… GET /queue/status - é˜Ÿåˆ—çŠ¶æ€

### 4. API Token (3/3)
- âœ… GET /tokens - Token åˆ—è¡¨
- âœ… POST /tokens - åˆ›å»º Token
- âœ… DELETE /tokens/:id - åˆ é™¤ Token

### 5. å®¡è®¡æ—¥å¿— (1/1)
- âœ… GET /audit-logs - å®¡è®¡æ—¥å¿—åˆ—è¡¨

### 6. å…¨å±€æœç´¢ (1/1)
- âœ… GET /search - å…¨å±€æœç´¢

### 7. ç»Ÿè®¡æ•°æ® (3/3)
- âœ… GET /stats/overview - æ¦‚è§ˆç»Ÿè®¡
- âœ… GET /stats/models - æ¨¡å‹ç»Ÿè®¡
- âœ… GET /stats/trends - è¶‹åŠ¿ç»Ÿè®¡

---

## âš ï¸ éœ€è¦ä¼˜åŒ–çš„æ¨¡å— (70-90%)

### 1. ç”¨æˆ·ç®¡ç† (3/4 - 75%)
âœ… é€šè¿‡:
- GET /users - ç”¨æˆ·åˆ—è¡¨
- GET /users/me - å½“å‰ç”¨æˆ·ä¿¡æ¯
- PUT /users/me - æ›´æ–°å½“å‰ç”¨æˆ·

âŒ å¤±è´¥:
- POST /users/me/avatar - **éœ€è¦æ–‡ä»¶ä¸Šä¼ æ”¯æŒ**

**å»ºè®®**: å®ç°æ–‡ä»¶ä¸Šä¼ æµ‹è¯•æˆ–è·³è¿‡è¯¥æµ‹è¯•

---

### 2. æç¤ºè¯ç®¡ç† (8/11 - 73%)
âœ… é€šè¿‡:
- GET /prompts - æç¤ºè¯åˆ—è¡¨
- POST /prompts - åˆ›å»ºæç¤ºè¯
- GET /prompts/:id - æç¤ºè¯è¯¦æƒ…
- PUT /prompts/:id - æ›´æ–°æç¤ºè¯
- GET /prompts/:id/versions - ç‰ˆæœ¬åˆ—è¡¨
- GET /prompts/:id/versions/diff - ç‰ˆæœ¬å¯¹æ¯”
- GET /prompts/:id/branches - åˆ†æ”¯åˆ—è¡¨
- DELETE /prompts/:id - åˆ é™¤æç¤ºè¯

âŒ å¤±è´¥:
- POST /prompts/:id/test - **æµ‹è¯•ç«¯ç‚¹è¿”å›é”™è¯¯**
- POST /prompts/:id/branches - **åˆ›å»ºåˆ†æ”¯å¤±è´¥**
- POST /prompts/batch - **æ‰¹é‡åˆ›å»ºå¤±è´¥**

**å»ºè®®**: æ£€æŸ¥è¿™ä¸‰ä¸ª POST ç«¯ç‚¹çš„å®ç°å’Œå‚æ•°éªŒè¯

---

### 3. æ•°æ®é›†ç®¡ç† (6/8 - 75%)
âœ… é€šè¿‡:
- GET /datasets - æ•°æ®é›†åˆ—è¡¨
- GET /datasets/:id - æ•°æ®é›†è¯¦æƒ…
- GET /datasets/:id/rows - æ•°æ®è¡Œ
- GET /datasets/:id/versions - ç‰ˆæœ¬åˆ—è¡¨
- GET /datasets/templates/qa - QA æ¨¡æ¿
- GET /datasets/templates/rag - RAG æ¨¡æ¿

âŒ å¤±è´¥:
- POST /datasets/:id/upload - **éœ€è¦æ–‡ä»¶ä¸Šä¼ **
- GET /datasets/:id/download - **æ–‡ä»¶ä¸‹è½½æµ‹è¯•**

**å»ºè®®**: å®ç°æ–‡ä»¶ä¸Šä¼ /ä¸‹è½½æµ‹è¯•æˆ–è·³è¿‡

---

### 4. æ¨¡å‹é…ç½® (6/7 - 86%)
âœ… é€šè¿‡:
- GET /providers - Provider åˆ—è¡¨
- GET /providers/:id - Provider è¯¦æƒ…
- POST /providers/:id/test - æµ‹è¯• Provider
- GET /models - æ¨¡å‹åˆ—è¡¨
- GET /models/:id - æ¨¡å‹è¯¦æƒ…
- POST /models/:id/test - æµ‹è¯•æ¨¡å‹

âŒ å¤±è´¥:
- GET /providers/:id/models - **Provider çš„æ¨¡å‹åˆ—è¡¨å¤±è´¥**

**å»ºè®®**: æ£€æŸ¥è¯¥ç«¯ç‚¹çš„å®ç°

---

## âŒ éœ€è¦ä¿®å¤çš„æ¨¡å— (<70%)

### 1. å®šæ—¶ä»»åŠ¡ (1/5 - 20%)
âœ… é€šè¿‡:
- GET /scheduled-tasks - å®šæ—¶ä»»åŠ¡åˆ—è¡¨

âŒ å¤±è´¥ (æ— æµ‹è¯•æ•°æ®):
- GET /scheduled-tasks/:id - è¯¦æƒ…
- GET /scheduled-tasks/:id/executions - æ‰§è¡Œå†å²
- POST /scheduled-tasks/:id/toggle - å¼€å…³
- POST /scheduled-tasks/:id/run-now - ç«‹å³æ‰§è¡Œ

**åŸå› **: æ•°æ®åº“ä¸­æ²¡æœ‰å®šæ—¶ä»»åŠ¡æ•°æ®
**å»ºè®®**: åœ¨æ•°æ®åº“ seed è„šæœ¬ä¸­æ·»åŠ æµ‹è¯•æ•°æ®ï¼Œæˆ–åœ¨æµ‹è¯•ä¸­å…ˆåˆ›å»ºå®šæ—¶ä»»åŠ¡

---

### 2. å‘Šè­¦ç³»ç»Ÿ (2/6 - 33%)
âœ… é€šè¿‡:
- GET /alert-rules - å‘Šè­¦è§„åˆ™åˆ—è¡¨
- GET /alerts - å‘Šè­¦åˆ—è¡¨

âŒ å¤±è´¥ (æ— æµ‹è¯•æ•°æ®):
- GET /alert-rules/:id - è§„åˆ™è¯¦æƒ…
- POST /alert-rules/:id/toggle - å¼€å…³è§„åˆ™
- POST /alerts/:id/acknowledge - ç¡®è®¤å‘Šè­¦
- POST /alerts/:id/resolve - è§£å†³å‘Šè­¦

**åŸå› **: æ•°æ®åº“ä¸­æ²¡æœ‰å‘Šè­¦è§„åˆ™å’Œå‘Šè­¦æ•°æ®
**å»ºè®®**: åœ¨æ•°æ®åº“ seed è„šæœ¬ä¸­æ·»åŠ æµ‹è¯•æ•°æ®

---

### 3. å›¢é˜Ÿç®¡ç† (1/7 - 14%)
âœ… é€šè¿‡:
- GET /teams - å›¢é˜Ÿåˆ—è¡¨

âŒ å¤±è´¥ (æ— æµ‹è¯•æ•°æ®):
- GET /teams/:id - å›¢é˜Ÿè¯¦æƒ…
- GET /teams/:id/members - æˆå‘˜åˆ—è¡¨
- POST /teams/:id/members - æ·»åŠ æˆå‘˜
- PUT /teams/:id/members/:userId - æ›´æ–°æˆå‘˜è§’è‰²
- DELETE /teams/:id/members/:userId - ç§»é™¤æˆå‘˜
- POST /teams/:id/transfer - è½¬è®©å›¢é˜Ÿ

**åŸå› **: æ•°æ®åº“ä¸­æ²¡æœ‰å›¢é˜Ÿæ•°æ®
**å»ºè®®**: åœ¨æ•°æ®åº“ seed è„šæœ¬ä¸­æ·»åŠ æµ‹è¯•å›¢é˜Ÿ

---

### 4. é€šçŸ¥æ¸ é“ (1/3 - 33%)
âœ… é€šè¿‡:
- GET /notify-channels - é€šçŸ¥æ¸ é“åˆ—è¡¨

âŒ å¤±è´¥ (æ— æµ‹è¯•æ•°æ®):
- GET /notify-channels/:id - æ¸ é“è¯¦æƒ…
- POST /notify-channels/:id/test - æµ‹è¯•æ¸ é“

**åŸå› **: æ•°æ®åº“ä¸­æ²¡æœ‰é€šçŸ¥æ¸ é“æ•°æ®
**å»ºè®®**: åœ¨æ•°æ®åº“ seed è„šæœ¬ä¸­æ·»åŠ æµ‹è¯•æ•°æ®

---

## ğŸ” é—®é¢˜åˆ†æ

### ä¸»è¦é—®é¢˜ç±»å‹

#### 1. ç¼ºå°‘æµ‹è¯•æ•°æ® (17 ä¸ªå¤±è´¥)
- **å½±å“æ¨¡å—**: å®šæ—¶ä»»åŠ¡ã€å‘Šè­¦ç³»ç»Ÿã€å›¢é˜Ÿç®¡ç†ã€é€šçŸ¥æ¸ é“
- **åŸå› **: æ•°æ®åº“ seed è„šæœ¬æœªåŒ…å«è¿™äº›æ¨¡å—çš„æµ‹è¯•æ•°æ®
- **è§£å†³æ–¹æ¡ˆ**:
  1. æ›´æ–° `prisma/seed.ts` æ·»åŠ æµ‹è¯•æ•°æ®
  2. æˆ–åœ¨æµ‹è¯•å¼€å§‹æ—¶é€šè¿‡ API åˆ›å»ºæµ‹è¯•æ•°æ®
  3. é‡æ–°è¿è¡Œ `pnpm db:seed`

#### 2. æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ (3 ä¸ªå¤±è´¥)
- **å½±å“æ¨¡å—**: ç”¨æˆ·ç®¡ç†ã€æ•°æ®é›†ç®¡ç†
- **åŸå› **: æ–‡ä»¶ä¸Šä¼ éœ€è¦ multipart/form-dataï¼Œå½“å‰æµ‹è¯•ä½¿ç”¨ JSON
- **è§£å†³æ–¹æ¡ˆ**:
  1. ä½¿ç”¨ FormData å®ç°æ–‡ä»¶ä¸Šä¼ æµ‹è¯•
  2. æˆ–å°†è¿™äº›æµ‹è¯•æ ‡è®°ä¸ºè·³è¿‡

#### 3. API å®ç°é—®é¢˜ (3 ä¸ªå¤±è´¥)
- POST /prompts/:id/test
- POST /prompts/:id/branches
- POST /prompts/batch
- GET /providers/:id/models

**éœ€è¦æ£€æŸ¥è¿™äº›ç«¯ç‚¹çš„å…·ä½“é”™è¯¯åŸå› **

---

## ğŸ“‹ è¡ŒåŠ¨è®¡åˆ’

### ä¼˜å…ˆçº§ 1: ä¿®å¤æ•°æ®ç¼ºå¤±é—®é¢˜
```bash
# æ›´æ–° seed è„šæœ¬ï¼Œæ·»åŠ ä»¥ä¸‹æµ‹è¯•æ•°æ®:
1. è‡³å°‘ 1 ä¸ªå®šæ—¶ä»»åŠ¡ (ScheduledTask)
2. è‡³å°‘ 1 ä¸ªå‘Šè­¦è§„åˆ™ (AlertRule)
3. è‡³å°‘ 1 ä¸ªå‘Šè­¦ (Alert)
4. è‡³å°‘ 1 ä¸ªå›¢é˜Ÿ (Team) åŠæˆå‘˜
5. è‡³å°‘ 1 ä¸ªé€šçŸ¥æ¸ é“ (NotifyChannel)

# é‡æ–° seed
pnpm db:seed
```

### ä¼˜å…ˆçº§ 2: ä¿®å¤ API å®ç°é—®é¢˜
1. æ£€æŸ¥ `/prompts/:id/test` ç«¯ç‚¹çš„é”™è¯¯æ—¥å¿—
2. æ£€æŸ¥ `/prompts/:id/branches` åˆ†æ”¯åˆ›å»ºé€»è¾‘
3. æ£€æŸ¥ `/prompts/batch` æ‰¹é‡åˆ›å»ºé€»è¾‘
4. æ£€æŸ¥ `/providers/:id/models` ç«¯ç‚¹å®ç°

### ä¼˜å…ˆçº§ 3: æ–‡ä»¶ä¸Šä¼ æµ‹è¯•
- å®ç°åŸºäº FormData çš„æ–‡ä»¶ä¸Šä¼ æµ‹è¯•
- æˆ–å°†æ–‡ä»¶ç›¸å…³æµ‹è¯•æ ‡è®°ä¸ºæ‰‹åŠ¨æµ‹è¯•

---

## ğŸ¯ é¢„æœŸæ”¹è¿›

å®Œæˆä¸Šè¿°ä¿®å¤åï¼Œé¢„è®¡æµ‹è¯•é€šè¿‡ç‡å¯ä»¥æå‡åˆ°:

| å½“å‰ | ç›®æ ‡ |
|------|------|
| 73% (54/74) | **95%+ (70+/74)** |

å‰©ä½™ 5% ä¸ºæ–‡ä»¶ä¸Šä¼ ç­‰éœ€è¦ç‰¹æ®Šå¤„ç†çš„æµ‹è¯•ç”¨ä¾‹ã€‚

---

## ğŸ“ ç»“è®º

1. **æ ¸å¿ƒåŠŸèƒ½æ­£å¸¸**: è®¤è¯ã€è¯„ä¼°å™¨ã€ä»»åŠ¡ç®¡ç†ã€Tokenã€æœç´¢ã€ç»Ÿè®¡ç­‰æ ¸å¿ƒæ¨¡å— 100% é€šè¿‡
2. **ä¸»è¦é—®é¢˜**: ç¼ºå°‘æµ‹è¯•æ•°æ®å¯¼è‡´éƒ¨åˆ†æ¨¡å—æµ‹è¯•å¤±è´¥
3. **æ¬¡è¦é—®é¢˜**: å°‘æ•° API ç«¯ç‚¹éœ€è¦æ£€æŸ¥å®ç°
4. **å»ºè®®**: ä¼˜å…ˆå®Œå–„æ•°æ®åº“ seed è„šæœ¬ï¼Œç„¶åä¿®å¤ API å®ç°é—®é¢˜

**æ•´ä½“è¯„ä»·**: API å®ç°è´¨é‡è‰¯å¥½ï¼Œä¸»è¦éœ€è¦è¡¥å……æµ‹è¯•æ•°æ®å’Œä¿®å¤ä¸ªåˆ«ç«¯ç‚¹ã€‚
