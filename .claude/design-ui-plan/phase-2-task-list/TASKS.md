# Phase 2: ä»»åŠ¡åˆ—è¡¨å¢å¼º - ä»»åŠ¡æ¸…å•

## ä»»åŠ¡æ¦‚è§ˆ

| ä»»åŠ¡ ID | ä»»åŠ¡åç§° | æ”¹åŠ¨æ–‡ä»¶æ•° | ä»£ç é‡ | çŠ¶æ€ |
|---------|----------|-----------|--------|------|
| P2-T1 | åˆ›å»º TaskCard ä»»åŠ¡å¡ç‰‡ç»„ä»¶ | 2 | ~300 è¡Œ | âœ… |
| P2-T2 | åˆ›å»º TaskProgress è¿›åº¦å±•ç¤ºç»„ä»¶ | 2 | ~80 è¡Œ | âœ… (å·²æœ‰) |
| P2-T3 | åˆ›å»º TaskFilters ç­›é€‰å™¨ç»„ä»¶ | 2 | ~130 è¡Œ | âœ… |
| P2-T4 | åˆ›å»º TaskEmptyState ç©ºçŠ¶æ€ç»„ä»¶ | 2 | ~100 è¡Œ | âœ… |
| P2-T5 | ä¼˜åŒ– useTaskList Hook æ”¯æŒè½®è¯¢ | 1 | ~140 è¡Œ | âœ… |
| P2-T6 | é‡æ„ä»»åŠ¡åˆ—è¡¨é¡µé¢é›†æˆç»„ä»¶ | 1 | ~140 è¡Œ | âœ… |

---

## P2-T1: åˆ›å»º TaskCard ä»»åŠ¡å¡ç‰‡ç»„ä»¶

### ä»»åŠ¡æè¿°
åˆ›å»ºä»»åŠ¡å¡ç‰‡ç»„ä»¶ï¼Œæ ¹æ®ä»»åŠ¡çŠ¶æ€å±•ç¤ºä¸åŒçš„å¸ƒå±€å’Œæ“ä½œ

### æ–‡ä»¶æ¸…å•
- `apps/web/src/components/task/TaskCard.tsx` (æ–°å¢)
- `apps/web/src/components/task/index.ts` (æ–°å¢å¯¼å‡º)

### ç»„ä»¶æ¥å£
```typescript
type TaskStatus = 'PENDING' | 'RUNNING' | 'COMPLETED' | 'FAILED' | 'PAUSED';

type TaskCardProps = {
  id: string;
  name: string;
  status: TaskStatus;
  type: 'SINGLE' | 'AB_TEST';

  // è¿è¡Œä¸­ä»»åŠ¡
  progress?: number;        // 0-100
  total?: number;
  completed?: number;
  passed?: number;
  failed?: number;
  estimatedTime?: string;   // "2åˆ†é’Ÿ"

  // å·²å®Œæˆä»»åŠ¡
  passRate?: number;        // 0-100
  duration?: string;        // "3åˆ†28ç§’"
  finishedAt?: string;      // "10åˆ†é’Ÿå‰"

  // å›è°ƒ
  onView?: () => void;
  onCancel?: () => void;
  onRerun?: () => void;
  onExport?: () => void;
}
```

### çŠ¶æ€å¸ƒå±€å·®å¼‚

**RUNNING çŠ¶æ€**:
- æ˜¾ç¤ºè¿›åº¦æ¡
- æ˜¾ç¤ºç»Ÿè®¡æŒ‡æ ‡ï¼ˆæ€»æ•°/å·²å®Œæˆ/é€šè¿‡/å¤±è´¥ï¼‰
- æ˜¾ç¤ºé¢„ä¼°å‰©ä½™æ—¶é—´
- æ“ä½œï¼šæŸ¥çœ‹è¯¦æƒ…ã€ç»ˆæ­¢

**COMPLETED/FAILED çŠ¶æ€**:
- æ˜¾ç¤ºé€šè¿‡ç‡
- æ˜¾ç¤ºè€—æ—¶ã€å®Œæˆæ—¶é—´
- æ“ä½œï¼šæŸ¥çœ‹è¯¦æƒ…ã€é‡æ–°è¿è¡Œã€å¯¼å‡ºæŠ¥å‘Š

**PENDING çŠ¶æ€**:
- æ˜¾ç¤ºç­‰å¾…ä¸­æç¤º
- æ“ä½œï¼šæŸ¥çœ‹è¯¦æƒ…ã€å–æ¶ˆ

### éªŒæ”¶æ ‡å‡†
- [x] å„çŠ¶æ€å¸ƒå±€æ­£ç¡®
- [x] æ“ä½œæŒ‰é’®æ­£å¸¸è§¦å‘
- [x] å¡ç‰‡ hover æ•ˆæœ
- [x] AB æµ‹è¯•ç±»å‹æœ‰æ ‡è¯†

---

## P2-T2: åˆ›å»º TaskProgress è¿›åº¦å±•ç¤ºç»„ä»¶

### ä»»åŠ¡æè¿°
åˆ›å»ºå¯å¤ç”¨çš„è¿›åº¦å±•ç¤ºç»„ä»¶ï¼Œæ”¯æŒè¿›åº¦æ¡å’Œç»Ÿè®¡æŒ‡æ ‡

### æ–‡ä»¶æ¸…å•
- `apps/web/src/components/task/TaskProgress.tsx` (æ–°å¢)
- `apps/web/src/components/task/index.ts` (æ›´æ–°å¯¼å‡º)

### ç»„ä»¶æ¥å£
```typescript
type TaskProgressProps = {
  total: number;
  completed: number;
  passed: number;
  failed: number;
  status: 'active' | 'success' | 'exception' | 'normal';
  showEstimate?: boolean;
  estimatedTime?: string;
}
```

### å¸ƒå±€ç»“æ„
```
è¿›åº¦: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘ 72% (72/100)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ€»æ•°    â”‚  â”‚ å·²å®Œæˆ   â”‚  â”‚ é€šè¿‡    â”‚  â”‚ å¤±è´¥    â”‚
â”‚ 100     â”‚  â”‚ 72      â”‚  â”‚ 68      â”‚  â”‚ 4       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é¢„ä¼°å‰©ä½™: 2åˆ†é’Ÿ
```

### éªŒæ”¶æ ‡å‡†
- [x] è¿›åº¦æ¡åŠ¨ç”»æµç•…
- [x] æ•°å€¼å®æ—¶æ›´æ–°
- [x] æ”¯æŒæˆåŠŸ/å¤±è´¥çŠ¶æ€é¢œè‰²

---

## P2-T3: åˆ›å»º TaskFilters ç­›é€‰å™¨ç»„ä»¶

### ä»»åŠ¡æè¿°
åˆ›å»ºä»»åŠ¡ç­›é€‰å™¨ç»„ä»¶ï¼ŒåŒ…å«æœç´¢ã€ç±»å‹ã€çŠ¶æ€ã€æ—¶é—´èŒƒå›´

### æ–‡ä»¶æ¸…å•
- `apps/web/src/components/task/TaskFilters.tsx` (æ–°å¢)
- `apps/web/src/components/task/index.ts` (æ›´æ–°å¯¼å‡º)

### ç»„ä»¶æ¥å£
```typescript
type TaskFiltersValue = {
  search?: string;
  type?: 'SINGLE' | 'AB_TEST' | 'all';
  status?: TaskStatus | 'all';
  timeRange?: 'today' | 'week' | 'month' | 'all';
}

type TaskFiltersProps = {
  value: TaskFiltersValue;
  onChange: (value: TaskFiltersValue) => void;
  onCreateTask?: () => void;
}
```

### å¸ƒå±€ç»“æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ” æœç´¢ä»»åŠ¡åç§°...                           â”‚  â”‚ + åˆ›å»ºä»»åŠ¡ â–¼   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç­›é€‰: [å…¨éƒ¨ç±»å‹ â–¼] [å…¨éƒ¨çŠ¶æ€ â–¼] [æ—¶é—´èŒƒå›´ â–¼]            [åˆ·æ–°]
```

### åˆ›å»ºä»»åŠ¡ä¸‹æ‹‰èœå•
- æ–°å»ºæµ‹è¯•ä»»åŠ¡
- æ–°å»º A/B æµ‹è¯•

### éªŒæ”¶æ ‡å‡†
- [x] æœç´¢æ¡†å®æ—¶è¿‡æ»¤
- [x] ä¸‹æ‹‰èœå•æ­£å¸¸å·¥ä½œ
- [x] åˆ›å»ºä»»åŠ¡æŒ‰é’®ä½¿ç”¨æ¸å˜æ ·å¼
- [x] åˆ·æ–°æŒ‰é’®è§¦å‘åˆ—è¡¨åˆ·æ–°

---

## P2-T4: åˆ›å»º TaskEmptyState ç©ºçŠ¶æ€ç»„ä»¶

### ä»»åŠ¡æè¿°
åˆ›å»ºä»»åŠ¡åˆ—è¡¨ç©ºçŠ¶æ€ç»„ä»¶ï¼Œæä¾›å¼•å¯¼æ€§å†…å®¹

### æ–‡ä»¶æ¸…å•
- `apps/web/src/components/task/TaskEmptyState.tsx` (æ–°å¢)
- `apps/web/src/components/task/index.ts` (æ›´æ–°å¯¼å‡º)

### ç»„ä»¶æ¥å£
```typescript
type TaskEmptyStateProps = {
  filtered?: boolean;  // æ˜¯å¦æ˜¯ç­›é€‰åæ— ç»“æœ
  onCreateTask?: () => void;
  onClearFilter?: () => void;
}
```

### ä¸¤ç§çŠ¶æ€

**æ— ä»»åŠ¡**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                         â”‚
â”‚              â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®            â”‚
â”‚              â”‚           âš¡                â”‚            â”‚
â”‚              â”‚                             â”‚            â”‚
â”‚              â”‚     è¿˜æ²¡æœ‰åˆ›å»ºæµ‹è¯•ä»»åŠ¡       â”‚            â”‚
â”‚              â”‚                             â”‚            â”‚
â”‚              â”‚   åˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ªæµ‹è¯•ä»»åŠ¡ï¼Œ   â”‚            â”‚
â”‚              â”‚   éªŒè¯ AI æ¨¡å‹çš„è¾“å‡ºè´¨é‡     â”‚            â”‚
â”‚              â”‚                             â”‚            â”‚
â”‚              â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚            â”‚
â”‚              â”‚   â”‚   + åˆ›å»ºæµ‹è¯•ä»»åŠ¡     â”‚   â”‚            â”‚
â”‚              â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚            â”‚
â”‚              â”‚                             â”‚            â”‚
â”‚              â”‚   ğŸ“– æŸ¥çœ‹ä½¿ç”¨æ–‡æ¡£           â”‚            â”‚
â”‚              â”‚                             â”‚            â”‚
â”‚              â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯            â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç­›é€‰æ— ç»“æœ**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                         â”‚
â”‚              â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®            â”‚
â”‚              â”‚           ğŸ”                â”‚            â”‚
â”‚              â”‚                             â”‚            â”‚
â”‚              â”‚     æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„ä»»åŠ¡       â”‚            â”‚
â”‚              â”‚                             â”‚            â”‚
â”‚              â”‚   å°è¯•è°ƒæ•´ç­›é€‰æ¡ä»¶           â”‚            â”‚
â”‚              â”‚                             â”‚            â”‚
â”‚              â”‚   [æ¸…é™¤ç­›é€‰æ¡ä»¶]            â”‚            â”‚
â”‚              â”‚                             â”‚            â”‚
â”‚              â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯            â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### éªŒæ”¶æ ‡å‡†
- [x] åŒºåˆ†æ— æ•°æ®å’Œç­›é€‰æ— ç»“æœ
- [x] æŒ‰é’®ç‚¹å‡»è§¦å‘å›è°ƒ
- [x] æ ·å¼ç¬¦åˆè®¾è®¡è§„èŒƒ

---

## P2-T5: ä¼˜åŒ– useTaskList Hook æ”¯æŒè½®è¯¢

### ä»»åŠ¡æè¿°
ä¼˜åŒ–ä»»åŠ¡åˆ—è¡¨ Hookï¼Œæ”¯æŒè¿è¡Œä¸­ä»»åŠ¡çš„è½®è¯¢æ›´æ–°

### æ–‡ä»¶æ¸…å•
- `apps/web/src/hooks/useTaskList.ts` (ä¿®æ”¹)

### Hook æ¥å£
```typescript
type UseTaskListOptions = {
  filters?: TaskFiltersValue;
  pageSize?: number;
  pollInterval?: number;  // è½®è¯¢é—´éš”ï¼Œé»˜è®¤ 3000ms
  enablePolling?: boolean; // æ˜¯å¦å¯ç”¨è½®è¯¢
}

type UseTaskListReturn = {
  tasks: TaskItem[];
  loading: boolean;
  error: Error | null;
  pagination: {
    current: number;
    pageSize: number;
    total: number;
  };
  hasRunningTasks: boolean;
  refresh: () => void;
  setPage: (page: number) => void;
}
```

### è½®è¯¢é€»è¾‘
- å½“å­˜åœ¨ RUNNING çŠ¶æ€ä»»åŠ¡æ—¶è‡ªåŠ¨å¯ç”¨è½®è¯¢
- è½®è¯¢é—´éš”å¯é…ç½®ï¼Œé»˜è®¤ 3 ç§’
- é¡µé¢ä¸å¯è§æ—¶æš‚åœè½®è¯¢
- ç»„ä»¶å¸è½½æ—¶æ¸…ç†è½®è¯¢

### éªŒæ”¶æ ‡å‡†
- [x] è½®è¯¢æ­£å¸¸å¯åŠ¨/åœæ­¢
- [x] é¡µé¢éšè—æ—¶æš‚åœ
- [x] è¿›åº¦æ•°æ®å®æ—¶æ›´æ–°
- [x] æ— å†…å­˜æ³„æ¼

---

## P2-T6: é‡æ„ä»»åŠ¡åˆ—è¡¨é¡µé¢é›†æˆç»„ä»¶

### ä»»åŠ¡æè¿°
é‡æ„ä»»åŠ¡åˆ—è¡¨é¡µé¢ï¼Œé›†æˆæ‰€æœ‰æ–°ç»„ä»¶

### æ–‡ä»¶æ¸…å•
- `apps/web/src/app/(dashboard)/tasks/page.tsx` (ä¿®æ”¹)
- `apps/web/src/styles/tasks.module.css` (æ–°å¢ï¼Œå¯é€‰)

### é¡µé¢ç»“æ„
```tsx
export default function TasksPage() {
  const [filters, setFilters] = useState<TaskFiltersValue>({});
  const { tasks, loading, pagination, hasRunningTasks, refresh, setPage } = useTaskList({
    filters,
    enablePolling: true,
  });

  return (
    <div className="tasks-page">
      <PageHeader title="æµ‹è¯•ä»»åŠ¡" />

      <TaskFilters
        value={filters}
        onChange={setFilters}
        onCreateTask={() => router.push('/tasks/new')}
      />

      {tasks.length === 0 ? (
        <TaskEmptyState
          filtered={hasFilters}
          onCreateTask={() => router.push('/tasks/new')}
          onClearFilter={() => setFilters({})}
        />
      ) : (
        <div className="task-list">
          {tasks.map(task => (
            <TaskCard
              key={task.id}
              {...task}
              onView={() => router.push(`/tasks/${task.id}`)}
              onCancel={() => handleCancel(task.id)}
              onRerun={() => handleRerun(task.id)}
            />
          ))}
        </div>
      )}

      <Pagination
        current={pagination.current}
        pageSize={pagination.pageSize}
        total={pagination.total}
        onChange={setPage}
      />
    </div>
  );
}
```

### éªŒæ”¶æ ‡å‡†
- [x] é¡µé¢å¸ƒå±€ç¬¦åˆè®¾è®¡
- [x] ç­›é€‰åŠŸèƒ½æ­£å¸¸
- [x] åˆ†é¡µåŠŸèƒ½æ­£å¸¸
- [x] è½®è¯¢æ›´æ–°æ­£å¸¸

---

## å¼€å‘æ—¥å¿—

| æ—¥æœŸ | ä»»åŠ¡ | å®Œæˆæƒ…å†µ | å¤‡æ³¨ |
|------|------|---------|------|
| 2025-12-04 | P2-T1 ~ P2-T6 | âœ… å…¨éƒ¨å®Œæˆ | ä»»åŠ¡åˆ—è¡¨é¡µé¢ä»è¡¨æ ¼å¸ƒå±€é‡æ„ä¸ºå¡ç‰‡å¸ƒå±€ï¼Œæ–°å¢ç­›é€‰å™¨ã€ç©ºçŠ¶æ€ç»„ä»¶ï¼Œæ”¯æŒè½®è¯¢æ›´æ–° |

---

## å®ç°æ€»ç»“

### æ–°å¢æ–‡ä»¶
- `apps/web/src/components/task/TaskCard.tsx` - ä»»åŠ¡å¡ç‰‡ç»„ä»¶ï¼ˆ~300è¡Œï¼‰
- `apps/web/src/components/task/TaskFilters.tsx` - ç­›é€‰å™¨ç»„ä»¶ï¼ˆ~130è¡Œï¼‰
- `apps/web/src/components/task/TaskEmptyState.tsx` - ç©ºçŠ¶æ€ç»„ä»¶ï¼ˆ~100è¡Œï¼‰
- `apps/web/src/hooks/useTaskList.ts` - ä»»åŠ¡åˆ—è¡¨ Hookï¼ˆ~140è¡Œï¼‰

### ä¿®æ”¹æ–‡ä»¶
- `apps/web/src/components/task/index.ts` - æ–°å¢å¯¼å‡º
- `apps/web/src/app/(dashboard)/tasks/page.tsx` - é‡æ„ä¸ºå¡ç‰‡å¸ƒå±€

### åŠŸèƒ½äº®ç‚¹
1. **TaskCard** æ ¹æ®çŠ¶æ€å±•ç¤ºä¸åŒå¸ƒå±€ï¼ˆRUNNING/COMPLETED/PENDING/PAUSEDï¼‰
2. **TaskFilters** æ¸å˜æŒ‰é’®æ ·å¼ï¼Œæœç´¢+ç­›é€‰+åˆ›å»ºä¸€ä½“åŒ–
3. **TaskEmptyState** åŒºåˆ†æ— æ•°æ®å’Œç­›é€‰æ— ç»“æœä¸¤ç§åœºæ™¯
4. **useTaskList** è‡ªåŠ¨è½®è¯¢æœºåˆ¶ï¼Œé¡µé¢ä¸å¯è§æ—¶æš‚åœ
