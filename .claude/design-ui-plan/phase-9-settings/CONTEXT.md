# Phase 9: 设置页面重构

## 阶段概述

**目标**：优化设置页面布局，增强分组卡片化和保存反馈

**优先级**：P3

**前置依赖**：无

**涉及页面**：`/settings/*` (设置相关页面)

## 当前问题

1. 左侧菜单层次结构可以更清晰
2. 表单布局基本合理但可优化
3. 缺少保存成功的视觉反馈
4. 设置项分组不够明确

## 优化目标

### 分组卡片化
- 每个设置分组使用独立卡片
- 卡片标题明确
- 相关设置项集中

### 保存反馈优化
- 保存按钮状态变化
- 成功通知
- 表单脏状态提示

## 设计规范

### 设置页面布局
```
┌─────────────────────────────────────────────────────────────────────────┐
│  设置                                                                    │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌─────────────┐  ┌───────────────────────────────────────────────────┐ │
│  │             │  │                                                   │ │
│  │ 👤 个人信息 │  │ ⚙️ 通用设置                                        │ │
│  │             │  │ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │ │
│  │ 🔐 账号安全 │  │                                                   │ │
│  │             │  │ ┌─────────────────────────────────────────────┐   │ │
│  │ 🔔 通知设置 │  │ │ 基本设置                                     │   │ │
│  │             │  │ │ ───────────────────────────────────────────│   │ │
│  │ 🔑 API Token│  │ │                                             │   │ │
│  │             │  │ │ 站点名称                                    │   │ │
│  │ ────────── │  │ │ ┌───────────────────────────────────────┐  │   │ │
│  │             │  │ │ │ AI 测试平台                           │  │   │ │
│  │ 👥 团队设置 │  │ │ └───────────────────────────────────────┘  │   │ │
│  │             │  │ │                                             │   │ │
│  │ ⚙️ 通用设置│◀ │ │ 默认分页大小                                │   │ │
│  │             │  │ │ ┌───────────────────────────────────────┐  │   │ │
│  │ 👤 用户管理 │  │ │ │ 20 条/页                         ▼    │  │   │ │
│  │             │  │ │ └───────────────────────────────────────┘  │   │ │
│  │ 📋 操作日志 │  │ │                                             │   │ │
│  │             │  │ └─────────────────────────────────────────────┘   │ │
│  │             │  │                                                   │ │
│  │             │  │ ┌─────────────────────────────────────────────┐   │ │
│  │             │  │ │ 区域与语言                                   │   │ │
│  │             │  │ │ ───────────────────────────────────────────│   │ │
│  │             │  │ │                                             │   │ │
│  │             │  │ │ 默认时区      │ 界面语言                    │   │ │
│  │             │  │ │ ┌───────────┐ │ ┌─────────────────────┐    │   │ │
│  │             │  │ │ │ UTC+8  ▼  │ │ │ 简体中文         ▼ │    │   │ │
│  │             │  │ │ └───────────┘ │ └─────────────────────┘    │   │ │
│  │             │  │ │                                             │   │ │
│  │             │  │ └─────────────────────────────────────────────┘   │ │
│  │             │  │                                                   │ │
│  │             │  │                     [重置]  [💾 保存设置]         │ │
│  │             │  │                                                   │ │
│  └─────────────┘  └───────────────────────────────────────────────────┘ │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 设置分组卡片
```
┌─────────────────────────────────────────────────────────────────┐
│ 基本设置                                                         │
│ ───────────────────────────────────────────────────────────────  │
│                                                                  │
│ 站点名称                                                         │
│ 用于页面标题和邮件通知                                           │
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ AI 测试平台                                                 │ │
│ └─────────────────────────────────────────────────────────────┘ │
│                                                                  │
│ 默认分页大小                                                     │
│ 列表页面默认显示条数                                             │
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ 20 条/页                                               ▼    │ │
│ └─────────────────────────────────────────────────────────────┘ │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 保存状态反馈
```typescript
// 保存按钮状态
type SaveButtonState = 'idle' | 'saving' | 'saved' | 'error';

// idle: [💾 保存设置] (primary)
// saving: [保存中...] (loading)
// saved: [✓ 已保存] (success, 2秒后恢复)
// error: [保存失败] (danger)
```

### 左侧菜单分组
```
个人
─────────────
👤 个人信息
🔐 账号安全
🔔 通知设置
🔑 API Token

团队
─────────────
👥 团队设置

系统
─────────────
⚙️ 通用设置
👤 用户管理
📋 操作日志
```

## 涉及文件

```
apps/web/src/
├── app/(dashboard)/settings/
│   ├── layout.tsx                          # 设置布局 (修改)
│   ├── page.tsx                            # 重定向到第一个设置
│   └── general/page.tsx                    # 通用设置页面 (修改)
├── components/settings/
│   ├── SettingsLayout.tsx                  # 设置布局组件 (新增)
│   ├── SettingsMenu.tsx                    # 左侧菜单组件 (新增)
│   ├── SettingsCard.tsx                    # 设置卡片组件 (新增)
│   ├── SaveButton.tsx                      # 保存按钮组件 (新增)
│   └── index.ts
└── hooks/
    └── useSettingsForm.ts                  # 设置表单 Hook (新增)
```

## 验收标准

### 功能
- [ ] 菜单导航正常
- [ ] 表单保存正常
- [ ] 保存反馈正确

### 视觉
- [ ] 卡片分组清晰
- [ ] 保存状态变化
- [ ] 菜单层次分明

### 体验
- [ ] 表单脏状态提示
- [ ] 快捷键保存
