# Phase 5: 验证与修复

## 阶段目标

通过系统性测试验证 L1 智能水平达标，修复发现的问题。

## 验证维度

### 1. 意图理解准确率

**目标**: 单一明确意图识别准确率 > 95%

测试方法：
- 准备 50 个标准测试用例
- 每个用例有明确的预期结果
- 统计准确率

### 2. 资源覆盖完整性

**目标**: 所有 20 种资源类型可正常操作

测试方法：
- 对每种资源类型执行 CRUD 操作
- 记录成功/失败情况

### 3. 用户体验满意度

**目标**: 新用户 3 分钟内能理解系统

测试方法：
- 邀请 3-5 名测试用户
- 观察首次使用体验
- 收集反馈

## 测试用例设计

### A. 导航类测试（10 个）

| ID | 输入 | 预期意图 | 预期操作 |
|----|------|---------|---------|
| N01 | "打开模型配置" | navigation | 导航到 /models |
| N02 | "去提示词页面" | navigation | 导航到 /prompts |
| N03 | "进入设置" | navigation | 导航到 /settings |
| N04 | "看看数据集" | navigation | 导航到 /datasets |
| N05 | "打开定时任务" | navigation | 导航到 /scheduled |
| N06 | "查看监控" | navigation | 导航到 /monitor |
| N07 | "open models" | navigation | 导航到 /models |
| N08 | "go to tasks" | navigation | 导航到 /tasks |
| N09 | "首页" | navigation | 导航到 / |
| N10 | "仪表盘" | navigation | 导航到 / |

### B. 创建类测试（10 个）

| ID | 输入 | 预期意图 | 预期操作 |
|----|------|---------|---------|
| C01 | "创建一个提示词" | creation | 导航到 /prompts/new |
| C02 | "新建数据集" | creation | 打开创建数据集弹窗 |
| C03 | "添加一个模型" | creation | 打开添加模型弹窗 |
| C04 | "新增供应商" | creation | 打开添加供应商弹窗 |
| C05 | "创建测试任务" | creation | 导航到 /tasks/new |
| C06 | "新建评估器" | creation | 导航到 /evaluators/new |
| C07 | "添加定时任务" | creation | 打开创建定时任务弹窗 |
| C08 | "创建告警规则" | creation | 打开创建告警弹窗 |
| C09 | "添加通知渠道" | creation | 打开创建通知弹窗 |
| C10 | "create a prompt" | creation | 导航到 /prompts/new |

### C. 模糊匹配测试（10 个）

| ID | 输入 | 预期行为 |
|----|------|---------|
| F01 | "打开prompt" | 识别为 prompt，导航到 /prompts |
| F02 | "创建个ds" | 识别为 dataset，打开创建弹窗 |
| F03 | "添加llm" | 识别为 model，打开添加弹窗 |
| F04 | "查看模版" | 识别为 prompt，导航到 /prompts |
| F05 | "打开定时" | 识别为 scheduled_task，导航到 /scheduled |
| F06 | "创建实验分支" | 识别为 prompt_branch，打开创建弹窗 |
| F07 | "发布版本" | 识别为 prompt_version，打开发布弹窗 |
| F08 | "添加厂商" | 识别为 provider，打开添加弹窗 |
| F09 | "新建告警" | 识别为 alert_rule，打开创建弹窗 |
| F10 | "配置通知" | 识别为 notify_channel，打开创建弹窗 |

### D. 复杂意图测试（10 个）

| ID | 输入 | 预期行为 |
|----|------|---------|
| X01 | "用GPT4测试一下" | 识别 model=GPT4，需要补充 prompt 和 dataset |
| X02 | "帮我创建一个情感分析的prompt" | 创建 prompt，名称含"情感分析" |
| X03 | "打开刚才那个任务" | 需要澄清"哪个任务" |
| X04 | "删掉旧的数据集" | 需要澄清"哪个数据集" |
| X05 | "查看test开头的提示词" | 查询 prompt，筛选 name like 'test%' |
| X06 | "把这个提示词发布一下" | 需要上下文确定"这个"是哪个 |
| X07 | "帮我看看" | 需要澄清"看什么" |
| X08 | "测试" | 需要澄清"测试什么" |
| X09 | "创建一个和昨天一样的任务" | 需要澄清"昨天的任务"是哪个 |
| X10 | "对比一下v1和v2" | 需要澄清"对比什么的v1和v2" |

### E. 边界情况测试（10 个）

| ID | 输入 | 预期行为 |
|----|------|---------|
| E01 | "" | 不执行，等待输入 |
| E02 | "   " | 不执行，等待输入 |
| E03 | "asdfghjkl" | 无法理解，请求重新输入 |
| E04 | "帮帮帮帮帮" | 无法理解，请求重新输入 |
| E05 | "打开不存在的页面" | 提示页面不存在 |
| E06 | "删除系统" | 拒绝危险操作 |
| E07 | "SELECT * FROM users" | 拒绝 SQL 注入 |
| E08 | "<script>alert(1)</script>" | 拒绝 XSS |
| E09 | 超长输入（>1000字符） | 截断或拒绝 |
| E10 | "创建1000个提示词" | 拒绝批量创建 |

## 验收清单

### L1 达标检查

- [ ] **意图分类**
  - [ ] 导航意图准确率 > 95%
  - [ ] 创建意图准确率 > 95%
  - [ ] 查询意图准确率 > 90%
  - [ ] 未知意图正确触发澄清

- [ ] **实体识别**
  - [ ] 资源类型识别准确率 > 90%
  - [ ] 资源名称模糊匹配成功率 > 80%
  - [ ] 多实体场景正确识别

- [ ] **资源覆盖**
  - [ ] 20 种资源类型全部可访问
  - [ ] 14 种实体资源全部可 CRUD
  - [ ] 弹窗触发正确

- [ ] **用户体验**
  - [ ] TODO 列表使用自然语言
  - [ ] 进度显示正确
  - [ ] 澄清对话友好

## 依赖

- Phase 1-4 全部完成

## 产出

1. 测试报告（包含准确率统计）
2. Bug 列表
3. 优化建议
